------------------------------------------8<----8<------------------------------------------------
Following https://fedoraproject.org/wiki/Kerberos_KDC_Quickstart_Guide

vim -O /etc/krb5.conf /var/kerberos/krb5kdc/kdc.conf

Edited `/etc/hosts` to add `mindfruit.krb` and `kerberos.mindfruit.krb` to `127.0.0.1`
```
michaelg@fedora:ipc++$ sudo /usr/sbin/kdb5_util -r MINDFRUIT.KRB create -s
Initializing database '/var/kerberos/krb5kdc/principal' for realm 'MINDFRUIT.KRB',
master key name 'K/M@MINDFRUIT.KRB'
You will be prompted for the database Master Password.
It is important that you NOT FORGET this password.
Enter KDC database master key: 
Re-enter KDC database master key to verify:
```
Farcical.Mosaic.29

Then use `kadmin.local` (from https://web.mit.edu/kerberos/krb5-1.12/doc/admin/admin_commands/kadmin_local.html):
> kadmin and kadmin.local are command-line interfaces to the Kerberos V5 administration system. They provide
> nearly identical functionalities; the difference is that kadmin.local directly accesses the KDC database,
> while kadmin performs operations using kadmind.

Where `hostname -A` returns
```
fedora fedora fedora
```

I think this this is redundant:
I create principal `admin/fedora` for `kadmin` (even though it's local):
```
root@fedora:/var/kerberos/krb5kdc# kadmin.local -r MINDFRUIT.KRB -q "addprinc admin/fedora"
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
No policy specified for admin/fedora@MINDFRUIT.KRB; defaulting to no policy
Enter password for principal "admin/fedora@MINDFRUIT.KRB": 
Re-enter password for principal "admin/fedora@MINDFRUIT.KRB": 
Principal "admin/fedora@MINDFRUIT.KRB" created.
```
Generous.Egghat.13

```
michaelg@fedora:ipc++$ sudo /sbin/service krb5kdc start
Redirecting to /bin/systemctl start krb5kdc.service
```
```
root@fedora:/var/kerberos/krb5kdc# systemctl status krb5kdc.service
● krb5kdc.service - Kerberos 5 KDC
     Loaded: loaded (/usr/lib/systemd/system/krb5kdc.service; disabled; preset: disabled)
    Drop-In: /usr/lib/systemd/system/service.d
             └─10-timeout-abort.conf
     Active: active (running) since Mon 2025-09-15 11:35:09 BST; 22s ago
 Invocation: 8dcdf3b5e8e947f9b907e4dcd0b5eb78
    Process: 76722 ExecStart=/usr/sbin/krb5kdc -P /run/krb5kdc.pid $KRB5KDC_ARGS (code=exited, status=0/SUCCESS)
   Main PID: 76724 (krb5kdc)
      Tasks: 1 (limit: 18587)
     Memory: 4.5M (peak: 5.2M)
        CPU: 23ms
     CGroup: /system.slice/krb5kdc.service
             └─76724 /usr/sbin/krb5kdc -P /run/krb5kdc.pid

Sep 15 11:35:09 fedora systemd[1]: Starting krb5kdc.service - Kerberos 5 KDC...
Sep 15 11:35:09 fedora systemd[1]: krb5kdc.service: Can't open PID file '/run/krb5kdc.pid' (yet?) after start: No such file or directory
Sep 15 11:35:09 fedora systemd[1]: Started krb5kdc.service - Kerberos 5 KDC.
```

```
michaelg@fedora:ipc++$ sudo /sbin/service kadmin start
Redirecting to /bin/systemctl start kadmin.service
```
```
root@fedora:/var/kerberos/krb5kdc# systemctl restart kadmin.service
root@fedora:/var/kerberos/krb5kdc# systemctl status kadmin.service
● kadmin.service - Kerberos 5 Password-changing and Administration
     Loaded: loaded (/usr/lib/systemd/system/kadmin.service; disabled; preset: disabled)
    Drop-In: /usr/lib/systemd/system/service.d
             └─10-timeout-abort.conf
     Active: active (running) since Mon 2025-09-15 11:36:41 BST; 2s ago
 Invocation: 5fe0e1da91864f2b8c388236a7e7397f
    Process: 76834 ExecStart=/usr/sbin/kadmind -P /run/kadmind.pid $KADMIND_ARGS (code=exited, status=0/SUCCESS)
   Main PID: 76836 (kadmind)
      Tasks: 1 (limit: 18587)
     Memory: 22.1M (peak: 22.1M)
        CPU: 138ms
     CGroup: /system.slice/kadmin.service
             └─76836 /usr/sbin/kadmind -P /run/kadmind.pid

Sep 15 11:36:41 fedora systemd[1]: Starting kadmin.service - Kerberos 5 Password-changing and Administration...
Sep 15 11:36:41 fedora systemd[1]: Started kadmin.service - Kerberos 5 Password-changing and Administration.
```

```
michaelg@fedora:ipc++$ sudo /usr/sbin/kadmin.local -r MINDFRUIT.KRB -q "addprinc michaelg"
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
No policy specified for michaelg/admin@MINDFRUIT.KRB; defaulting to no policy
Enter password for principal "michaelg/admin@MINDFRUIT.KRB": 
Re-enter password for principal "michaelg/admin@MINDFRUIT.KRB": 
Principal "michaelg/admin@MINDFRUIT.KRB" created.
```
Fortunate.Mandible.71

Check the database:
```
root@fedora:/var/kerberos/krb5kdc# kdb5_util -r MINDFRUIT.KRB tabdump -ce keydata
name,keyindex,kvno,enctype,key,salttype,salt
K/M@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,20009ac149f47ce519b54f8e1cbf899b4e287912b99fdbe129809558b42dea7b240024b5a4182e543835d9346fcc3a4d722eadcce92cf3ce626e1fc87152379dbacbd93a9c440beab8b6,normal,
admin/fedora@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,2000a391fb4b176b0300fe8b687942068cb1c4091680346df0b4886ba4afe3ae3eee0d9e2ab7905e129fbb4be4e1334a31c3b54c8369ade31e574afc846fe74d411b4e6927d2097f1079,normal,
admin/fedora@MINDFRUIT.KRB,1,1,aes128-cts-hmac-sha256-128,1000173acf5e520b7e7973beec4198e6b144ccb4bd689f3a51a98b4bb500feccdc95fb413ed4a73511cfd24adcc4e359a5d1ebb27c9be401a7be,normal,
admin/fedora@MINDFRUIT.KRB,2,1,aes256-cts-hmac-sha1-96,20001b5a1675562849eda97fb8e6c46b37fa63347a8c067384a7a67f045275a456321eb7f38d1353ab6619a58db9a4a2234fc9daa5200b85db3eb50322a161f9d61d5ae8fecf057475e3,normal,
admin/fedora@MINDFRUIT.KRB,3,1,aes128-cts-hmac-sha1-96,1000a3e5b1ac241c8129e7e6028ec6f5fa76725cf28e9c77643502a9921640351d8ec8663998338f5799936853b3f3e0a595af2ef60bdbb0b76f,normal,
admin/fedora@MINDFRUIT.KRB,4,1,camellia256-cts-cmac,20009cd6a0ec37f32ad8b806fdec124849d7922882cab70936844b1b07394bdd1b4fae0264f238d13ccd7f49c9b051b4adeec391a60408f39383c86ec5e7638a1788d12b02e14cfd0d3c,normal,
admin/fedora@MINDFRUIT.KRB,5,1,camellia128-cts-cmac,100085a168c0585e2aebcddcbfdca500c2fc6b2a05e4fbaf04ad0c0d3cefbdba7465d6df86d5066173f942b494e2d6250c974642e2a4f2cd7a13,normal,
admin/fedora@MINDFRUIT.KRB,6,1,arcfour-hmac,10001f17a8524fef03bd485fc5de846a877bbd49c3574f17a4d0c9edf57e1b9e03a02b804d715ba17195a5ba46ac38a2151896258a72fd031ce7,normal,
kadmin/admin@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,20004a9105e04751229402f580b253beacd3cab6422c8d75c7a9c0e398c7a7eb9d656e5239daaa53679ac6c37c97d1b62af9905ad219d00397b4f3d3deb694b43ccec126936637b87631,normal,
kadmin/admin@MINDFRUIT.KRB,1,1,aes128-cts-hmac-sha256-128,10001d1cebd9267101721feb0b6a4eb7b2e987ca640ef2336ed8ce2770119e5cc6049ccc1dd248d32dc359fe5008d986ae232e63370ddea3752c,normal,
kadmin/admin@MINDFRUIT.KRB,2,1,aes256-cts-hmac-sha1-96,2000e35fe6f817f5dd98a22efbe1d49257ae625d0cc3e9acf42993fb1a7b6173e04eebd1fa438707c4fee3ec7094802a7d7a913f854ee73db425b52143481dd222023a96c574acc02822,normal,
kadmin/admin@MINDFRUIT.KRB,3,1,aes128-cts-hmac-sha1-96,1000b522fb044a4c15e80bae13fcbe2721ce892ae4e392d12f590745528e4105af86d4a08c63b4b7000d31685ae27ab8f550209732d134081d3b,normal,
kadmin/admin@MINDFRUIT.KRB,4,1,camellia256-cts-cmac,2000a8956bfbe15a2e80cf65faecfdc7c5166f363bfc8ef7406ea6fb4dbb040e755d3fedb12e5867614f37d60bf96737d23d0107a32979ebe0debfc847dbf988c671aeb8d61cf7aacf5f,normal,
kadmin/admin@MINDFRUIT.KRB,5,1,camellia128-cts-cmac,1000af3403f155f3344665ddf0f03072561086a20bb557e472603001ff10a9b4b9e4419eb2ea6972fcfe1789b423cee8eac5e0ed87d911e265f3,normal,
kadmin/admin@MINDFRUIT.KRB,6,1,arcfour-hmac,100084708742c08a28d95fe52afcc4a46bff923ffe66cb5407aeae28c4cae8bf002f3736bcd4314a41eb63cbe286ccc27f55a2be438d82467531,normal,
kadmin/changepw@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,200003dab9197812c5fdf2ac7fe593c86a4ce7548cabf96341aed88e37c89c4597a037cd90327d0ea40cfbd6eff694b4fc3bea8fa136d302cb34f27c5fae369d76cc293359e31e7d72fd,normal,
kadmin/changepw@MINDFRUIT.KRB,1,1,aes128-cts-hmac-sha256-128,100009ad37aeddea2631675d17a3aadd795bcb957258e37fd621089381bd629ff02d6f9546ae3837e2463a67a22b8ff81bb9f8122838227cfc85,normal,
kadmin/changepw@MINDFRUIT.KRB,2,1,aes256-cts-hmac-sha1-96,200011101c224c32065ba7085f25f0269b784872c1281cd63d597a15ee4b6df927f4666ab45e086828b46a06fca4fd8fdbc03b190c80ac60450dbe9f1b6e72b118fa735e378e323b3f41,normal,
kadmin/changepw@MINDFRUIT.KRB,3,1,aes128-cts-hmac-sha1-96,100028ef02c46df0529f4b28858e4503c73683f6b8619fa7f0c12ec261efae2a1cb72653c94035c38f92958bfcf669be89ba54b93497f4cdb7f1,normal,
kadmin/changepw@MINDFRUIT.KRB,4,1,camellia256-cts-cmac,20000166d6c8c762677fbecc7c42c57bfbcd520f2068e6f5e9456f5921cbe854ad59dcbaac9252ebc925c423d21de9cb6db1134e06affe187cf759fb9023adb1ef5f92bca6a3bc5bd012,normal,
kadmin/changepw@MINDFRUIT.KRB,5,1,camellia128-cts-cmac,1000236a72c58705377fc5b36aa081daf0b94c98b2ba390938bccfb9f5855d8d87fe6ec55976b9b4530343f9d203bd77966d4debfba3517db944,normal,
kadmin/changepw@MINDFRUIT.KRB,6,1,arcfour-hmac,100064097a6d6ad0aa387cc390b4dd2f5df37333cfe452e018d9598503426a21b0bf12d8d5112b63159ca436e1b56f00f86361927f09cad36626,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,200019d80e55ddd16cdd8d6bb53addf158c9fe9c70705d6feb96798ddc48c1893e47e65a16907b56bf7ec43153b49c60fe7fea7b2219426979bf491995538dbdec54b02fc2934bbef173,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,1,1,aes128-cts-hmac-sha256-128,1000943ac249c4c532f773858e67514d239c706c6ef16efd5e6919f5d7b2ccca7db48f699207adf06129c904ae9c84b8dd9f502a4de43ad9709c,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,2,1,aes256-cts-hmac-sha1-96,2000c0e739a66c257ed74724c34df4e89c78064dff8efa65bae7574b4f8e705255e7ffb04b12cc0d942b6f52eb7b6d9a4319cd9447bd11ca2bae78d8b1d984a0539999a178c2964f2092,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,3,1,aes128-cts-hmac-sha1-96,10005c767a0981976eb2fd7b7aebba90875534f1c399e14a4334fb1d9b6de77619fa1be189878db80d9725b2361fb574a5f3b816d5b3db28df90,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,4,1,camellia256-cts-cmac,2000ba60b928f5cb0910956cca6ff216275269bafb631f03c26bc0544659491d4fe6ed4e2dfb2bb6acaeb319cbd8c86107996e5b26b3f80258bd547212f46266e3fbd9ffed7f8206c22a,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,5,1,camellia128-cts-cmac,10000467bc5e6d163d2fb723f9e95c9f739873887cacdd8faddd9ff728df5d6505075c1f97a7fb11c3f5bd3d8ff90408fc99f8f5dc139008995c,normal,
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB,6,1,arcfour-hmac,100054f5415f4ad29a5d848a77bc02034d43a98f33d455c4600f5b9e0a8bb3973d4ea644f521199eab5f032d1745b1fbd2e571fe1617c73f27da,normal,
michaelg@MINDFRUIT.KRB,0,1,aes256-cts-hmac-sha384-192,2000e5424a6daa268e2018210162f76420549b951a3bdc42dcca0fd55f310e4f6667b128e588db434c2e17ea990413f4cff565c352af3dcc156573593ee5b3c755c0240c03768f4eeefb,normal,
michaelg@MINDFRUIT.KRB,1,1,aes128-cts-hmac-sha256-128,1000dd57db8ebbadefc69badf5241010451354325c97d3e188c1022e7acaa3521df8c4814d19a01ba08509aae6ed7c734319446d7fd3529d89bf,normal,
michaelg@MINDFRUIT.KRB,2,1,aes256-cts-hmac-sha1-96,2000a896f3b26e68a6263e7c6d48cdd003309b4cc9a81f62a1ea58bce76408bc995a0712d3dab1288b8925d4661ee9d22885b5be7bd519df3c0e00cc2169dce3e126b03f396fc050ab6a,normal,
michaelg@MINDFRUIT.KRB,3,1,aes128-cts-hmac-sha1-96,10001ba9fe25f0c8452e3d132c90f798609131ceb4ce848e04a20ea05816c12f7f2ca33168e33b22fcd5f412c4b7ee145ac530ea4b55a66c8df5,normal,
michaelg@MINDFRUIT.KRB,4,1,camellia256-cts-cmac,200020b048adcbe858a8bb31cec132abeb86448e345ee97e9b16dbd4f40be5323b7ec65725c02013f7b6cb0839918d405efe9a238a6808151ef4ff08c36df3de10eeebdeda93da1ca8f8,normal,
michaelg@MINDFRUIT.KRB,5,1,camellia128-cts-cmac,10008cc0b58a87ecd4fa7b7e0ccb6fe2963424057d77f2de3d1cc3f9ec280909504a1ff3e76c553dd6677858f6c1a4126c5bcb11ad71315f3c67,normal,
michaelg@MINDFRUIT.KRB,6,1,arcfour-hmac,100009cce1c8779eaad738d289f8e3ae87c232140f191cf20ab6590826d6e91698bd6654a3c10c0248e9a835577894d160cd9b708dc7f5c95630,normal,
```

Run `kinit` passing `michaelg@MINDFRUIT.KRB`; it defaults to `michaelg/admin@MINDFRUIT.KRB`.
Use the `-c` switch:
```
michaelg@fedora:~$ kinit -C -c /home/michaelg/.krb5/krb5cc michaelg@MINDFRUIT.KRB
Password for michaelg@MINDFRUIT.KRB: 
```

OK, so now with `klist`:
```
michaelg@fedora:krb5$ klist ~/.krb5/krb5cc 
Ticket cache: FILE:/home/michaelg/.krb5/krb5cc
Default principal: michaelg@MINDFRUIT.KRB

Valid starting     Expires            Service principal
15/09/25 12:24:25  16/09/25 12:24:15  krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB
        renew until 15/09/25 12:24:25
```

Create a keytab. Using https://docs.fedoraproject.org/en-US/infra/howtos/create_keytab/.
```
michaelg@fedora:krb5$ kvno -c ~/.krb5/krb5cc michaelg@MINDFRUIT.KRB
michaelg@MINDFRUIT.KRB: kvno = 1
```

Run `ktutil`, and at its console, enter the following:
```
At the `ktutil` console, enter the information as follows, using password `Fortunate.Mandible.71` when prompted:
ktutil:  addent -password -p michaelg@MINDFRUIT.KRB -k 1 -f
Password for michaelg@MINDFRUIT.KRB:
ktutil:  write_kt /home/michaelg/.krb5/michaelg.keytab
ktutil:  quit
```

```
export KRB5_KTNAME=/home/michaelg/.krb5/michaelg.keytab
```


------------------------------------------8<----8<------------------------------------------------
I then logged out of my KDE session, and logged back in. It showed me a balloon warning that it
could not log-in via `michaelg/admin@MINDFRUIT.KRB`. If you click the balloon, it opens the "Online
Accounts" page in the KDE Settings applet. Here I deleted the `michaelg/admin@MINDFRUIT.KRB` 
account, leaving just the `michaelg@MINDFRUIT.KRB` account. I'm going to log-out and back in again
to see what happens ...

This seems to have worked. I didn't see the warning this time.
------------------------------------------8<----8<------------------------------------------------

Adding the HTTP service account and going to generate a keytab that I can reference via an 
environment variable for the KDB session. In RFC 4559 https://www.rfc-editor.org/rfc/rfc4559.html at
the end of section 4.1, we find: 

> When the Kerberos Version 5 GSSAPI mechanism [RFC4121] is being used, the
> HTTP server will be using a principal name of the form of "HTTP/hostname".

As `root`:
```
kadmin.local -r MINDFRUIT.KRB -q "addprinc -randkey -maxlife 0 HTTP/fedora"
```
and (via https://www.ibm.com/docs/en/spectrum-conductor/2.5.0?topic=hosts-creating-kerberos-principals-primary-compute-host-authentication)
```
kadmin.local -r MINDFRUIT.KRB -q "ktadd -k HTTP_fedora.keytab –norandkey HTTP/fedora@MINDFRUIT.KRB"
```
```
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
kadmin.local: Principal –norandkey does not exist.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type camellia256-cts-cmac added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type camellia128-cts-cmac added to keytab WRFILE:HTTP_fedora.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 2, encryption type arcfour-hmac added to keytab WRFILE:HTTP_fedora.keytab.
```
```
root@fedora:~# file HTTP_fedora.keytab
HTTP_fedora.keytab: Kerberos Keytab file, realm=MINDFRUIT.KRB, principal=HTTP/fedora, type=1, date=Mon Sep 15 12:21:34 2025, kvno=2
```

Check principals created:
```
root@fedora:~# kadmin.local
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
kadmin.local:  listprincs
HTTP/fedora@MINDFRUIT.KRB
K/M@MINDFRUIT.KRB
admin/fedora@MINDFRUIT.KRB
kadmin/admin@MINDFRUIT.KRB
kadmin/changepw@MINDFRUIT.KRB
krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB
michaelg@MINDFRUIT.KRB
root/admin@MINDFRUIT.KRB
```

---------------------------------------------8<----8<---------------------------------------------
I tried creating a `root/admin` ticket, per https://rangareddy.github.io/KerberoSetup/, adding a
`root/admin` principal. As `root`, do:
```
kadmin.local
addprinc root/admin
Cornelius.Gopher.19
```
Then 
```
kinit root/admin
```
using `Cornelius.Gopher.19`; then, test with `klist`, and remove with 
```
kdestroy -p root/admin
```
All checks out (no surprise, really). No need to repeat this.

---------------------------------------------8<----8<---------------------------------------------
Renewing expired tickets for the Client
---------------------------------------

When running gss_accept_sec_context we see the error GSS_S_CREDENTIALS_EXPIRED; to renew the ticket
we can run `kinit` with the `-R` option, as follows:
```
kinit -R -k -t /home/michaelg/.krb5/michaelg.keytab michaelg@MINDFRUIT.KRB
```
The longer output using `KRB5_TRACE` shows the following:
```
michaelg@fedora:build$ KRB5_TRACE=/dev/stdout kinit -R -k -t /home/michaelg/.krb5/michaelg.keytab michaelg@MINDFRUIT.KRB
```
```
[159005] 1758094669.644352: Matching michaelg@MINDFRUIT.KRB in collection with result: 0/Success
[159005] 1758094669.644353: Getting initial credentials for michaelg@MINDFRUIT.KRB
[159005] 1758094669.644354: Found entries for michaelg@MINDFRUIT.KRB in keytab: aes256-sha2
[159005] 1758094669.644356: Sending unauthenticated request
[159005] 1758094669.644357: Sending request (203 bytes) to MINDFRUIT.KRB
[159005] 1758094669.644358: Resolving hostname kerberos.mindfruit.krb
[159005] 1758094669.644359: Sending initial UDP request to dgram 127.0.0.1:88
[159005] 1758094669.644360: Received answer (473 bytes) from dgram 127.0.0.1:88
```
```
[159005] 1758094669.644361: Sending DNS URI query for _kerberos.MINDFRUIT.KRB.
[159005] 1758094669.644362: No URI records found
```
```
[159005] 1758094669.644363: Sending DNS SRV query for _kerberos-master._udp.MINDFRUIT.KRB.
[159005] 1758094669.644364: Sending DNS SRV query for _kerberos-master._tcp.MINDFRUIT.KRB.
[159005] 1758094669.644365: No SRV records found
```
```
[159005] 1758094669.644366: Response was not from primary KDC
[159005] 1758094669.644367: Received error from KDC: -1765328359/Additional pre-authentication required
[159005] 1758094669.644370: Preauthenticating using KDC method data
[159005] 1758094669.644371: Processing preauth types: PA-FX-FAST (136), PA-ETYPE-INFO2 (19), PA-SPAKE (151), PA-ENC-TIMESTAMP (2), PA-FX-COOKIE (133)
[159005] 1758094669.644372: Selected etype info: etype aes256-sha2, salt "MINDFRUIT.KRBmichaelg", params ""
[159005] 1758094669.644373: Received cookie: MIT1\x00\x00\x00\x01<\x91e\x01a\x1fr\x85\x94\xe5\x0f\xae\xa7H\xa5\x0e\x84\xd9.i\x96\xd1\xfe1B\xedre\xf5c\xf2\x0a\x90aT^\xf3\xcfY\xd5\x04\x1cQ\xea\x0f.4\x11r\xfa\xbet\xf5\x86\x86\x09\x07\x01{\x8a\x0d\xc8\x87Y5\xfb\x95{m\xae\xa7\xefw\xf0\xb4lu\Y\x8f\xb0\xf5\x17SRB\xbc\x94\x09S>\x91*\x1d_\xa0\x97\xe2\x00\xaa\xa2DE\xe5\xc6\xf5!\xcf\x1b\xdbg\xa5_\xbbP6O5\xb0P\xbe\x9f\xe8\x15\xd8J\x96>\xa2 \x90\x1f)\x1cbs\xf4/ev\x18\xd1
[159005] 1758094669.644374: SPAKE challenge received with group 1, pubkey FB1DC862BB39A499737687B10352C204AE67FFF338ECE16A552AE5990052BA73
[159005] 1758094669.644375: Retrieving michaelg@MINDFRUIT.KRB from FILE:/home/michaelg/.krb5/michaelg.keytab (vno 0, enctype aes256-sha2) with result: 0/Success
[159005] 1758094669.644376: SPAKE key generated with pubkey 2EF1AFF369E403DD333966096227308B417447790D184EFDC007DAD3F43290E3
[159005] 1758094669.644377: SPAKE algorithm result: 40777987E0B8E00D57FAD552D685F60FACC2E34E03A998FBF73D8BBB09A2C3A1
[159005] 1758094669.644378: SPAKE final transcript hash: C8CF0139FA0B991C181BAB1ECB183B2528A4366E7D8648AF6C1EC5DC774ED7E5
[159005] 1758094669.644379: Sending SPAKE response
[159005] 1758094669.644380: Preauth module spake (151) (real) returned: 0/Success
[159005] 1758094669.644381: Produced preauth for next request: PA-FX-COOKIE (133), PA-SPAKE (151)
[159005] 1758094669.644382: Sending request (486 bytes) to MINDFRUIT.KRB
[159005] 1758094669.644383: Resolving hostname kerberos.mindfruit.krb
[159005] 1758094669.644384: Sending initial UDP request to dgram 127.0.0.1:88
[159005] 1758094669.644385: Received answer (939 bytes) from dgram 127.0.0.1:88
[159005] 1758094669.644386: Sending DNS URI query for _kerberos.MINDFRUIT.KRB.
[159005] 1758094669.644387: No URI records found
[159005] 1758094669.644388: Sending DNS SRV query for _kerberos-master._udp.MINDFRUIT.KRB.
[159005] 1758094669.644389: Sending DNS SRV query for _kerberos-master._tcp.MINDFRUIT.KRB.
[159005] 1758094669.644390: No SRV records found
[159005] 1758094669.644391: Response was not from primary KDC
[159005] 1758094669.644392: Processing preauth types: PA-ETYPE-INFO2 (19)
[159005] 1758094669.644393: Selected etype info: etype aes256-sha2, salt "MINDFRUIT.KRBmichaelg", params ""
[159005] 1758094669.644394: Produced preauth for next request: (empty)
[159005] 1758094669.644395: AS key determined by preauth: aes256-sha2/1E70
[159005] 1758094669.644396: Decrypted AS reply; session key is: aes256-sha2/97CC
[159005] 1758094669.644397: FAST negotiation: available
[159005] 1758094669.644398: Resolving unique ccache of type MEMORY
[159005] 1758094669.644399: Initializing MEMORY:1VT8mrq with default princ michaelg@MINDFRUIT.KRB
[159005] 1758094669.644400: Storing config in MEMORY:1VT8mrq for krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB: fast_avail: yes
[159005] 1758094669.644401: Storing michaelg@MINDFRUIT.KRB -> krb5_ccache_conf_data/fast_avail/krbtgt\/MINDFRUIT.KRB\@MINDFRUIT.KRB@X-CACHECONF: in MEMORY:1VT8mrq
[159005] 1758094669.644402: Storing config in MEMORY:1VT8mrq for krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB: pa_type: 151
[159005] 1758094669.644403: Storing michaelg@MINDFRUIT.KRB -> krb5_ccache_conf_data/pa_type/krbtgt\/MINDFRUIT.KRB\@MINDFRUIT.KRB@X-CACHECONF: in MEMORY:1VT8mrq
[159005] 1758094669.644404: Storing michaelg@MINDFRUIT.KRB -> krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB in MEMORY:1VT8mrq
[159005] 1758094669.644405: Moving ccache MEMORY:1VT8mrq to KCM:1000:97235
[159005] 1758094669.644406: Initializing KCM:1000:97235 with default princ michaelg@MINDFRUIT.KRB
[159005] 1758094669.644407: Storing michaelg@MINDFRUIT.KRB -> krb5_ccache_conf_data/fast_avail/krbtgt\/MINDFRUIT.KRB\@MINDFRUIT.KRB@X-CACHECONF: in KCM:1000:97235
[159005] 1758094669.644408: Storing michaelg@MINDFRUIT.KRB -> krb5_ccache_conf_data/pa_type/krbtgt\/MINDFRUIT.KRB\@MINDFRUIT.KRB@X-CACHECONF: in KCM:1000:97235
[159005] 1758094669.644409: Storing michaelg@MINDFRUIT.KRB -> krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB in KCM:1000:97235
[159005] 1758094669.644410: Destroying ccache MEMORY:1VT8mrq
```
To add SRV records to the localhost, perhaps see an SO answer like this https://serverfault.com/a/1128282
```
michaelg@fedora:build$ klist --help
Usage: klist [-e] [-V] [[-c] [-l] [-A] [-d] [-f] [-s] [-a [-n]]] [-k [-i] [-t] [-K]] [-C] [name]
  -e shows the encryption type
  options for keytabs:
    -t shows keytab entry timestamps
    -K shows keytab entry keys
    -C includes configuration data entries
```
```
KRB5_KTNAME=/home/michaelg/.krb5/michaelg.keytab KRB5_TRACE=/dev/stdout klist -ektKC
```
```
Keytab name: FILE:/home/michaelg/.krb5/michaelg.keytab
KVNO Timestamp         Principal
---- ----------------- --------------------------------------------------------
   1 15/09/25 12:29:27 michaelg@MINDFRUIT.KRB (aes256-cts-hmac-sha384-192)  (0x403e118b1a74ac93931d4488261ce34443ee589275386a882fce8b61491b31ad)

```
---------------------------------------------8<----8<---------------------------------------------
Source RPMs
-----------
Homepage https://koji.fedoraproject.org/koji/rpminfo?rpmID=42998713
logs https://kojipkgs.fedoraproject.org//packages/krb5/1.21.3/6.fc42/data/logs/x86_64/
build.log https://kojipkgs.fedoraproject.org//packages/krb5/1.21.3/6.fc42/data/logs/x86_64/build.log
RPMs https://kojipkgs.fedoraproject.org//packages/krb5/1.21.3/6.fc42/x86_64/

Advice given on https://web.libera.chat/?channels=#fedora-admin at 2025-09-17 at 09:43:09
#kwizart said: fedpkg clone -a krb5 ; fedpkg switch-branch f42

---------------------------------------------8<----8<---------------------------------------------
Building krb5-1.21.3-final from source
--------------------------------------
autoreconf -fiv
./configure --prefix=$HOME/alt --enable-shared --without-ldap --with-tls-impl=openssl --with-crypto-impl=openssl --without-selinux --with-pam --with-prng-alg=os --without-lmdb --without-krb5-config
   this failed, so tried
./configure --prefix=$HOME/alt
   which worked, up to a point, as `make` then failed, so I tried
./configure CFLAGS="-fPIC -fno-strict-aliasing -fstack-protector-all" --prefix=$HOME/alt



------------------------------------------8<----8<------------------------------------------------
SPNEGO headers
--------------
RFC 4559 https://www.rfc-editor.org/rfc/rfc4559.html
We see the reply by the client to the `WWW-Authenticate: Negotiate` prompt is defined in section
4.2. The payload of the `Authorization` header is the base-64 encoding of the InitialContextToken,
as defined in RFC 2743 https://www.rfc-editor.org/rfc/rfc2743.

Since I'm running into the GSS_S_DEFECTIVE_TOKEN error, this is on point:

>  GSS_S_DEFECTIVE_TOKEN indicates that consistency checks performed on the
>  input_token failed, preventing further processing from being performed based
>  on that token.

The base-64 decode implementation I found on SO was actually the problem:

> / Referenced in https://stackoverflow.com/a/62128330, the commenter
> / referenced a reply to the k4 topicbox on August 16th 2019 (subject
> / "b64 encode") by Geo Carncross, which implements a base64 decoder.
> / Used without permission, please shout if that's not OK.
> .krb.b64d:{c:sum x="=";neg[c]_"c"$raze 256 vs'64 sv'0N 4#.Q.b6?x}

I haven't looked into how its output differs from the Base-64 decode I found at
https://web.mit.edu/freebsd/head/contrib/wpa/src/utils/base64.c

The following Microsoft link contains useful information about the SPNEGO tokens
https://learn.microsoft.com/en-us/previous-versions/ms995330(v=msdn.10)?redirectedfrom=MSDN#http-sso-2_topic1

---------------------------------------------8<----8<---------------------------------------------
Base-64 encoding
----------------
I see there's an MIT version https://web.mit.edu/freebsd/head/contrib/wpa/src/utils/base64.c

The above MIT version is apparently fastest at encoding, but not decoding. See other at the
comparison page: https://github.com/gaspardpetit/base64/

---------------------------------------------8<----8<---------------------------------------------
FIREFOX
-------

In firefox, using `about:config`, set this value:
```
network.negotiate-auth.trusted-uris	https://mindfruit.krb
```

### In the following fedorapeople.org link, at section 3.6.6
Just seen this: https://jfearn.fedorapeople.org/fdocs/en-US/Fedora/20/html/Security_Guide/index.html 

Using `sudo systemctl status kadmin.service`, we can see that the service is down. Also check `krb5kdc.service`.

Had to start the `kadmin.service` and `krb5kdc.service` items with `sudo systemctl start ...`
```
sudo systemctl start krb5kdc.service
sudo systemctl start kadmin.service
```

```
michaelg@fedora:krb5$ sudo -i
root@fedora:~# kadmin
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
Password for root/admin@MINDFRUIT.KRB: 
```
```
kadmin:  addprinc -randkey fedora/MINDFRUIT.KRB
No policy specified for fedora/MINDFRUIT.KRB@MINDFRUIT.KRB; defaulting to no policy
Principal "fedora/MINDFRUIT.KRB@MINDFRUIT.KRB" created.
```
```
kadmin:  ktadd -k /etc/krb5.keytab fedora/MINDFRUIT.KRB
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type camellia256-cts-cmac added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type camellia128-cts-cmac added to keytab WRFILE:/etc/krb5.keytab.
Entry for principal fedora/MINDFRUIT.KRB with kvno 2, encryption type arcfour-hmac added to keytab WRFILE:/etc/krb5.keytab.
```
timestamp,sync,nsHttp:5,cache2:5,nsSocketTransport:5,nsHostResolver:5,EarlyHint:5,negotiateauth:5

As `michaelg`, run
```
kinit
```
and enter the password; then
```
klist
```
and we see something like
```
Ticket cache: KCM:1000
Default principal: michaelg/admin@MINDFRUIT.KRB

Valid starting     Expires            Service principal
10/09/25 22:37:31  11/09/25 22:37:03  krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB
        renew until 10/09/25 22:37:31
```

Followed some steps from https://docs.redhat.com/en/documentation/red_hat_enterprise_linux/5/html/deployment_guide/sso-config-firefox
These included setting Firefox to set up logging:
```
```
Added to that the KRB5_TRACE environment variable:
```
export KRB5_TRACE=krb5_trace.log
```
then
```
firefox
```

And lo and behold, in the `krb5_trace.log` file, we see
```
[51802] 1757540417.512353: ccselect module realm chose cache KCM:1000 with client principal michaelg/admin@MINDFRUIT.KRB for server principal HTTP/fedora@MINDFRUIT.KRB
[51802] 1757540417.512354: Getting credentials michaelg/admin@MINDFRUIT.KRB -> HTTP/fedora@ using ccache KCM:1000
[51802] 1757540417.512355: Retrieving michaelg/admin@MINDFRUIT.KRB -> krb5_ccache_conf_data/start_realm@X-CACHECONF: from KCM:1000 with result: -1765328243/Matching credential not found
[51802] 1757540417.512356: Retrieving michaelg/admin@MINDFRUIT.KRB -> HTTP/fedora@ from KCM:1000 with result: -1765328243/Matching credential not found
[51802] 1757540417.512357: Retrying michaelg/admin@MINDFRUIT.KRB -> HTTP/fedora@MINDFRUIT.KRB with result: -1765328243/Matching credential not found
[51802] 1757540417.512358: Server has referral realm; starting with HTTP/fedora@MINDFRUIT.KRB
[51802] 1757540417.512359: Retrieving michaelg/admin@MINDFRUIT.KRB -> krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB from KCM:1000 with result: 0/Success
[51802] 1757540417.512360: Starting with TGT for client realm: michaelg/admin@MINDFRUIT.KRB -> krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB
[51802] 1757540417.512361: Requesting tickets for HTTP/fedora@MINDFRUIT.KRB, referrals on
[51802] 1757540417.512362: Generated subkey for TGS request: aes256-sha2/C1D3
[51802] 1757540417.512363: etypes requested in TGS request: aes256-sha2, aes128-sha2, aes256-cts, aes128-cts, camellia256-cts, camellia128-cts
[51802] 1757540417.512365: Encoding request body and padata into FAST request
[51802] 1757540417.512366: Sending request (1148 bytes) to MINDFRUIT.KRB
[51802] 1757540417.512367: Resolving hostname kerberos.mindfruit.krb
[51802] 1757540417.512368: Sending initial UDP request to dgram 127.0.0.1:88
[51802] 1757540417.512369: Received answer (444 bytes) from dgram 127.0.0.1:88
[51802] 1757540417.512370: Sending DNS URI query for _kerberos.MINDFRUIT.KRB.
[51802] 1757540417.512371: No URI records found
[51802] 1757540417.512372: Sending DNS SRV query for _kerberos-master._udp.MINDFRUIT.KRB.
[51802] 1757540417.512373: Sending DNS SRV query for _kerberos-master._tcp.MINDFRUIT.KRB.
[51802] 1757540417.512374: No SRV records found
[51802] 1757540417.512375: Response was not from primary KDC
[51802] 1757540417.512376: Decoding FAST response
[51802] 1757540417.512377: TGS request result: -1765328377/Server HTTP/fedora@MINDFRUIT.KRB not found in Kerberos database
[51802] 1757540417.512378: Requesting tickets for HTTP/fedora@MINDFRUIT.KRB, referrals off
[51802] 1757540417.512379: Generated subkey for TGS request: aes256-sha2/8797
[51802] 1757540417.512380: etypes requested in TGS request: aes256-sha2, aes128-sha2, aes256-cts, aes128-cts, camellia256-cts, camellia128-cts
[51802] 1757540417.512382: Encoding request body and padata into FAST request
[51802] 1757540417.512383: Sending request (1148 bytes) to MINDFRUIT.KRB
[51802] 1757540417.512384: Resolving hostname kerberos.mindfruit.krb
[51802] 1757540417.512385: Sending initial UDP request to dgram 127.0.0.1:88
[51802] 1757540417.512386: Received answer (444 bytes) from dgram 127.0.0.1:88
[51802] 1757540417.512387: Sending DNS URI query for _kerberos.MINDFRUIT.KRB.
[51802] 1757540417.512388: No URI records found
[51802] 1757540417.512389: Sending DNS SRV query for _kerberos-master._udp.MINDFRUIT.KRB.
[51802] 1757540417.512390: Sending DNS SRV query for _kerberos-master._tcp.MINDFRUIT.KRB.
[51802] 1757540417.512391: No SRV records found
[51802] 1757540417.512392: Response was not from primary KDC
[51802] 1757540417.512393: Decoding FAST response
[51802] 1757540417.512394: TGS request result: -1765328377/Server HTTP/fedora@MINDFRUIT.KRB not found in Kerberos database
```

---------------------------------------------8<----8<---------------------------------------------
Capturing Kerberos Traffic From Firefox
---------------------------------------

Running Firefox as follows:
```
KRB5_TRACE=firefox_krb5.log_$(date +%Y%m%d) KRB5_CLIENT_KTNAME=FILE:$HOME/.krb5/michaelg.keytab KRB5CCNAME=FILE:$HOME/.krb5/michaelg.ccache firefox
```

I'm running Wireshark as `root`.

When trying to decrypt the krb5 traffic, I was unable to get far because I couldn't find the server's
keytab to add to Wireshark's preferences (protocols->KRB5). This web-page https://wiki.archlinux.org/title/Kerberos
suggests that when using `kadmin.local` to add principals (via `addprinc`), you then add the KDC principal
to the server's keytab:
```
ktadd host/kerberos.example.com
```
So I did this, under `strace` and captured the output, as:
```
root# strace -e file kadmin.local -r MINDFRUIT.KRB
```
```
ktadd -glob *
```
Upon exiting, I then checked the `/etc/krb5.keytab` file with `klist`, which dumped a ton of stuff:
```
root@fedora:~# klist -k /etc/krb5.keytab -tKC
Keytab name: FILE:/etc/krb5.keytab
KVNO Timestamp         Principal
---- ----------------- --------------------------------------------------------
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0x6a2f8c4f561b8f5fe4aefbe58a84aeeebb395113eb23e31c04796caad9593acb)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0xddea83ad07aaf957ae6dd5e2243b5402)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0x5aae73b40f41a17bca900c42e8da29571b249caa0442212ff267813b61cdd78c)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0x47ca94c8bca885b7c2873d72dd1c17e2)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0x1ba8a7d8e6a32c876b1d63417325421073a2dbefb1522df7a988d9eedfd04aa3)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0x8e98174068d51370b42f319e46a36d7c)
   2 10/09/25 22:14:38 fedora/MINDFRUIT.KRB@MINDFRUIT.KRB (0xaaa4224b4ed099121d4eb64dbe00f4df)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0x11f76ce2962580f7cf45a58953474ee48a6d6e5f435f32869e91644ad4a6f4ec)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0xc6828c1ccc8ffa91b159cac8534cb933)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0xd329722cc3ca90aaab71240a73bfa1464d1af69f7b9d41ee157be4040276c294)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0x77b3871010fa3dd70a80d57397f171a2)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0x611369d96cc0b4f8305119b1948e4778982102ea6cab9da0f67e5d12a9cbda5e)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0x2e101211a13f1b604cfcf46e5d3550ae)
   3 19/09/25 11:55:40 HTTP/fedora@MINDFRUIT.KRB (0x2fc0e8ffe9a29d2c0b228e4678e4d26e)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x4ce507145e7cc04a046b8c394d05c5b2aeedbd44dc414d851f627111f08e2030)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0xa9dabb55145d9d706e5642d2ec9b0b40)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x06251a90ee47ffa2182c1356a39dfbf4f8280b9b5d2aa9ffb7a6ff6905650475)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x83f4cdabfdbbbe97f125fe249406e919)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x1b263da4757d77a05a1e3d32a539b4b0122599a835e6a8eae4f2b6c2f79a1457)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x8932f7fc264b504e5c04c280430dfb39)
   2 19/09/25 11:55:40 K/M@MINDFRUIT.KRB (0x762b87b95fbdf59c71e4c388f098c406)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0xbbaefde9abb3ff4c730acfbe6cdb08dce96693fbc34bad9205f07dad866c541b)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0x2cb118325f255e81af69e8e9244b7af1)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0x7b945363f46e8005625517903879f2505abe452d3285898bc3e7f4f9f9831dab)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0xa4ae5b886210c41329d37859f42507ec)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0xe13da2488f6d9232996124edba24c8b30cf56b3ea51764b6c59131a748cec483)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0xcee7cac9f43ccd5a757b1280fb197f0c)
   2 19/09/25 11:55:40 admin/fedora@MINDFRUIT.KRB (0x22875b897fbd2c00b49c12ad1d4f32bc)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0x163395d09d20696194bdeebff6c632eee26f29c46e9fcd485855b4ad5daac19a)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0xd8bf3979083154f036cf12387c8d6c0a)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0x39064a2270b859123cae3255a92a5d207ea05aedcc3da0d6d78f36648a13ffd8)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0xb09334b319b8e529526602a8ec1fccc8)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0x56c1ae0ca6c19f6df9c150ad3ca8c8897e17cfffd675370ef97da97aa9b63369)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0x67d1137062e06a4dca6500f4cc592115)
   2 19/09/25 11:55:40 kadmin/admin@MINDFRUIT.KRB (0x3ae95c730e9389ea6641f13d997781a4)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0x233db2a727e3b3673b011d3d222ab0bf23d7f6efec03175264503902f154ac5e)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0x7f200465db9d6db5c25772ece1ddc774)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0xfd484d637bb07698866cf0d06b3f0438f3ec60c4ddf60fab030475b3bfece60d)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0x396d351e84bf540e02457edbf26de2de)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0xbe871cfdeb345e71abcf74f4465efdcc7ca8539ab7f473115276b3e5915ab3eb)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0x18b27131743e62c8424f87d6b07a9792)
   2 19/09/25 11:55:40 kadmin/changepw@MINDFRUIT.KRB (0xfc4d36335ae38a2257edce376bde8fc6)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0x87cd1ef6f455a929c2c7e93d156b29a7b39cf87f55b63e8b9544f7992510fd68)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0x165de5a434f882329c6849d4e08cab4d)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0xd3f9939f51cbc3edd6b36d785a056aa5160b649113f308b64a9c6a75e14e4c1f)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0xfc424c0dee1624a00b894cfa31002fae)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0xdb44fd6f1049770830b809a2febe444f20a312fcace031cab20be3b3d632bf82)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0x7eeeb5a911752281e1373fcd23063f7e)
   2 19/09/25 11:55:40 krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (0x506d207568d50f43cb03c8ccd137f15e)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0xfe0bb9bcfed8fb602c3ba862fdb05b64e88e88258a60a3b06db297b0a2684afc)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0xdcd464e54fba0a8391c997ade96c198e)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0xee7935b48b5eb471d03ce9b9c3c3698b5ad22b37d14b02618977089056b730b6)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0x530c502d053d2c802a7a33b2ec6292a8)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0x5a0ab290b60cefff28b59f822024b914d1641f8f56bbbc79f84609bc9c49a373)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0x0b098ed781ee73625a851546ec3b1761)
   2 19/09/25 11:55:40 michaelg@MINDFRUIT.KRB (0x9a3241503fb67aad70c8222838eb5d7e)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0x11aec522c3cd527abc1f8c7578731de4efbb1a7f558d298a5c90e6d0f7ed10af)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0xd429d55dba9ea432ba0148b2e1eea5c3)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0x0ca099e4f04060230f5846af6b6d189a08f72342ad2f734eedf040ce620e884c)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0x006703a742ecd4a23c323ecb0e948543)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0x2ea07665a403654102b67c3260eeb312848fe334ace8f2bae25c6aed02c41289)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0x6dbd921511ac50f4c6543a790e0fe6fc)
   2 19/09/25 11:55:40 root/admin@MINDFRUIT.KRB (0xd3aa608f5db23dc7d7c248c2c4525715)
```

Unfortunately, I _still_ couldn't read the Wireshark traces.

I'll write to a new keytab file, with `-norandkey`; oh, wait, no I won't, for some reason `kadmin.local` now fails
with:
```
root@fedora:~# kadmin.local -r MINDFRUIT.KRB
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
kadmin.local: Decrypt integrity check failed while initializing kadmin.local interface
```
Then trying with the keytab file, it fails slightly differently...
```
root@fedora:~# kadmin.local -k /etc/krb5.keytab -r MINDFRUIT.KRB
kadmin.local: Decrypt integrity check failed while initializing kadmin.local interface
```
Ooops...
Going to rebuild the `/var/local/kerberos/krb5kdc` structures, preserving only the `kadm5.acl` and `kdc.conf` files.

So .. having run through the process again, and set up `HTTP_fedora.keytab` and `michaelg.keytab` (via `michaelg.ccache`), 
I've now dumped the credentials to a file name `globbed.keytab` but this time with the `-norandkey` option, which
seems to allow kadmin.local to work:
```
root@fedora:~# kadmin.local
Authenticating as principal root/admin@MINDFRUIT.KRB with password.
kadmin.local:  ktadd -k /root/globbed.keytab -norandkey -glob *
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal HTTP/fedora@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal K/M@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal admin/fedora@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/admin@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal kadmin/changepw@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha384-192 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha256-128 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type aes256-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type aes128-cts-hmac-sha1-96 added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type camellia256-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type camellia128-cts-cmac added to keytab WRFILE:/root/globbed.keytab.
Entry for principal michaelg@MINDFRUIT.KRB with kvno 1, encryption type arcfour-hmac added to keytab WRFILE:/root/globbed.keytab.
kadmin.local: Principal * does not exist.
kadmin.local:  q
```

Wireshark PCAP decrypted
------------------------
I set Wireshark's keytab file to `/root/globbed.keytab`. This permits decryption of AS-REP messages.

Here's the entire flow:

Initial AS-REQ, which is rejected:
```
Frame 1: 245 bytes on wire (1960 bits), 245 bytes captured (1960 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 54014, Dst Port: 88
Kerberos
    as-req
        pvno: 5
        msg-type: krb-as-req (10)
        padata: 2 items
            PA-DATA pA-AS-FRESHNESS
                padata-type: pA-AS-FRESHNESS (150)
                    padata-value: <MISSING>
            PA-DATA pA-REQ-ENC-PA-REP
                padata-type: pA-REQ-ENC-PA-REP (149)
                    padata-value: <MISSING>
        req-body
            Padding: 0
            kdc-options: 40800000
                0... .... = reserved: False
                .1.. .... = forwardable: True
                ..0. .... = forwarded: False
                ...0 .... = proxiable: False
                .... 0... = proxy: False
                .... .0.. = allow-postdate: False
                .... ..0. = postdated: False
                .... ...0 = unused7: False
                1... .... = renewable: True
                .0.. .... = unused9: False
                ..0. .... = unused10: False
                ...0 .... = opt-hardware-auth: False
                .... 0... = unused12: False
                .... .0.. = unused13: False
                .... ..0. = constrained-delegation: False
                .... ...0 = canonicalize: False
                0... .... = request-anonymous: False
                .0.. .... = unused17: False
                ..0. .... = unused18: False
                ...0 .... = unused19: False
                .... 0... = unused20: False
                .... .0.. = unused21: False
                .... ..0. = unused22: False
                .... ...0 = unused23: False
                0... .... = unused24: False
                .0.. .... = unused25: False
                ..0. .... = disable-transited-check: False
                ...0 .... = renewable-ok: False
                .... 0... = enc-tkt-in-skey: False
                .... .0.. = unused29: False
                .... ..0. = renew: False
                .... ...0 = validate: False
            cname
                name-type: kRB5-NT-PRINCIPAL (1)
                cname-string: 1 item
                    CNameString: michaelg
            realm: MINDFRUIT.KRB
            sname
                name-type: kRB5-NT-SRV-INST (2)
                sname-string: 2 items
                    SNameString: krbtgt
                    SNameString: MINDFRUIT.KRB
            till: Sep 20, 2025 12:33:14.000000000 BST
            rtime: Sep 26, 2025 12:33:14.000000000 BST
            nonce: 761944527
            etype: 6 items
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA256-128 (19)
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA1-96 (18)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA1-96 (17)
                ENCTYPE: eTYPE-CAMELLIA256-CTS-CMAC (26)
                ENCTYPE: eTYPE-CAMELLIA128-CTS-CMAC (25)
    [Response in: 2]

```

KRB Error:
```
Frame 2: 515 bytes on wire (4120 bits), 515 bytes captured (4120 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 88, Dst Port: 54014
Kerberos
    krb-error
        pvno: 5
        msg-type: krb-error (30)
        stime: Sep 19, 2025 12:33:14.000000000 BST
        susec: 253393
        error-code: eRR-PREAUTH-REQUIRED (25)
        crealm: MINDFRUIT.KRB
        cname
            name-type: kRB5-NT-PRINCIPAL (1)
            cname-string: 1 item
                CNameString: michaelg
        realm: MINDFRUIT.KRB
        sname
            name-type: kRB5-NT-SRV-INST (2)
            sname-string: 2 items
                SNameString: krbtgt
                SNameString: MINDFRUIT.KRB
        e-text: NEEDED_PREAUTH
        e-data […]: 3082012d300aa10402020088a2020400302ba103020113a22404223020301ea003020114a1171b154d494e4446525549542e4b52426d69636861656c673042a10402020097a23a0438a1363034a003020101a122042040b12c0a37d0f3f27126e92b3064602a12d9f90dfc0f247e5519f
            PA-DATA pA-FX-FAST
                padata-type: pA-FX-FAST (136)
                    padata-value: <MISSING>
            PA-DATA pA-ETYPE-INFO2
                padata-type: pA-ETYPE-INFO2 (19)
                    padata-value: 3020301ea003020114a1171b154d494e4446525549542e4b52426d69636861656c67
                        ETYPE-INFO2-ENTRY
                            etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                            salt: MINDFRUIT.KRBmichaelg
            PA-DATA pA-SPAKE
                padata-type: pA-SPAKE (151)
                    padata-value: a1363034a003020101a122042040b12c0a37d0f3f27126e92b3064602a12d9f90dfc0f247e5519fb3f22afe064a20930073005a003020101 challenge
                        challenge
                            group: sPAKEGroup-edwards25519 (1)
                            pubkey: 40b12c0a37d0f3f27126e92b3064602a12d9f90dfc0f247e5519fb3f22afe064
                            factors: 1 item
                                SPAKESecondFactor
                                    type: sPAKESecondFactor-SF-NONE (1)
            PA-DATA pA-ENC-TIMESTAMP
                padata-type: pA-ENC-TIMESTAMP (2)
                    padata-value: <MISSING>
            PA-DATA pA-FX-COOKIE
                padata-type: pA-FX-COOKIE (133)
                    padata-value […]: 4d49543100000001f030a04af767f95404e54bcf1b6fe2652ce91ef29cb94c7e67f4622da8d2af9ac6c58618390f3419a872e94daa93722ce177e5ccba18d9d6f7d840802621a7c1cd1bf19e66e644182436ebe5f72641fc5008a10cd09eaa6e51ebd024018adfa272fface15b3
    [Response to: 1]
    [Time from request: 0.000519271 seconds]

```


```
Frame 3: 528 bytes on wire (4224 bits), 528 bytes captured (4224 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 35153, Dst Port: 88
Kerberos
    as-req
        pvno: 5
        msg-type: krb-as-req (10)
        padata: 4 items
            PA-DATA pA-FX-COOKIE
                padata-type: pA-FX-COOKIE (133)
                    padata-value […]: 4d49543100000001f030a04af767f95404e54bcf1b6fe2652ce91ef29cb94c7e67f4622da8d2af9ac6c58618390f3419a872e94daa93722ce177e5ccba18d9d6f7d840802621a7c1cd1bf19e66e644182436ebe5f72641fc5008a10cd09eaa6e51ebd024018adfa272fface15b3
            PA-DATA pA-SPAKE
                padata-type: pA-SPAKE (151)
                    padata-value: a2623060a0220420598b60e430c0380343048eabc9373c38a3a482ddb044980043f90743286ce2caa13a3038a003020114a231042f0467d5cc24fe64dda0e577f4704bbd59d6968a1d0eb9caf50df629666f7efb2622469570d533de28f1cfcc213bd625 response
                        response
                            pubkey: 598b60e430c0380343048eabc9373c38a3a482ddb044980043f90743286ce2ca
                            factor
                                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                cipher: 0467d5cc24fe64dda0e577f4704bbd59d6968a1d0eb9caf50df629666f7efb2622469570d533de28f1cfcc213bd625
            PA-DATA pA-AS-FRESHNESS
                padata-type: pA-AS-FRESHNESS (150)
                    padata-value: <MISSING>
            PA-DATA pA-REQ-ENC-PA-REP
                padata-type: pA-REQ-ENC-PA-REP (149)
                    padata-value: <MISSING>
        req-body
            Padding: 0
            kdc-options: 40800000
                0... .... = reserved: False
                .1.. .... = forwardable: True
                ..0. .... = forwarded: False
                ...0 .... = proxiable: False
                .... 0... = proxy: False
                .... .0.. = allow-postdate: False
                .... ..0. = postdated: False
                .... ...0 = unused7: False
                1... .... = renewable: True
                .0.. .... = unused9: False
                ..0. .... = unused10: False
                ...0 .... = opt-hardware-auth: False
                .... 0... = unused12: False
                .... .0.. = unused13: False
                .... ..0. = constrained-delegation: False
                .... ...0 = canonicalize: False
                0... .... = request-anonymous: False
                .0.. .... = unused17: False
                ..0. .... = unused18: False
                ...0 .... = unused19: False
                .... 0... = unused20: False
                .... .0.. = unused21: False
                .... ..0. = unused22: False
                .... ...0 = unused23: False
                0... .... = unused24: False
                .0.. .... = unused25: False
                ..0. .... = disable-transited-check: False
                ...0 .... = renewable-ok: False
                .... 0... = enc-tkt-in-skey: False
                .... .0.. = unused29: False
                .... ..0. = renew: False
                .... ...0 = validate: False
            cname
                name-type: kRB5-NT-PRINCIPAL (1)
                cname-string: 1 item
                    CNameString: michaelg
            realm: MINDFRUIT.KRB
            sname
                name-type: kRB5-NT-SRV-INST (2)
                sname-string: 2 items
                    SNameString: krbtgt
                    SNameString: MINDFRUIT.KRB
            till: Sep 20, 2025 12:33:14.000000000 BST
            rtime: Sep 26, 2025 12:33:14.000000000 BST
            nonce: 507040266
            etype: 6 items
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA256-128 (19)
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA1-96 (18)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA1-96 (17)
                ENCTYPE: eTYPE-CAMELLIA256-CTS-CMAC (26)
                ENCTYPE: eTYPE-CAMELLIA128-CTS-CMAC (25)
    [Response in: 4]
```

Here's the decrypted AS-REP
```
Frame 4: 981 bytes on wire (7848 bits), 981 bytes captured (7848 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 88, Dst Port: 35153
Kerberos
    as-rep
        pvno: 5
        msg-type: krb-as-rep (11)
        padata: 1 item
            PA-DATA pA-ETYPE-INFO2
                padata-type: pA-ETYPE-INFO2 (19)
                    padata-value: 3020301ea003020114a1171b154d494e4446525549542e4b52426d69636861656c67
                        ETYPE-INFO2-ENTRY
                            etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                            salt: MINDFRUIT.KRBmichaelg
        crealm: MINDFRUIT.KRB
        cname
            name-type: kRB5-NT-PRINCIPAL (1)
            cname-string: 1 item
                CNameString: michaelg
        ticket
            tkt-vno: 5
            realm: MINDFRUIT.KRB
            sname
                name-type: kRB5-NT-SRV-INST (2)
                sname-string: 2 items
                    SNameString: krbtgt
                    SNameString: MINDFRUIT.KRB
            enc-part
                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                kvno: 1
                cipher […]: e95832a16234355db00c2c9a4ef90ab853b359eaeb68aac2f2d9a7f22d3c82c56fbca07dcc35ad0c07bf9aacf7562cb14665869081ed481fa492f2ad7138d3c030d37850b492f65985e7c47e1f9fe03c6874643d5bcf96ecc3443300747cecfdb8536e7edd695365e08d744deb6237b6d
                    Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                            [Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                            [Severity level: Chat]
                            [Group: Security]
                        [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=4)]
                            [Used keymap=all_keys num_keys=49 num_tries=4)]
                            [Severity level: Chat]
                            [Group: Security]
                    encTicketPart
                        Padding: 0
                        flags: 40e10000
                            0... .... = reserved: False
                            .1.. .... = forwardable: True
                            ..0. .... = forwarded: False
                            ...0 .... = proxiable: False
                            .... 0... = proxy: False
                            .... .0.. = may-postdate: False
                            .... ..0. = postdated: False
                            .... ...0 = invalid: False
                            1... .... = renewable: True
                            .1.. .... = initial: True
                            ..1. .... = pre-authent: True
                            ...0 .... = hw-authent: False
                            .... 0... = transited-policy-checked: False
                            .... .0.. = ok-as-delegate: False
                            .... ..0. = unused: False
                            .... ...1 = enc-pa-rep: True
                            0... .... = anonymous: False
                        key
                            Learnt encTicketPart_key keytype 20 (id=4.1) (f433cc69...)
                                [Expert Info (Chat/Security): Learnt encTicketPart_key keytype 20 (id=4.1) (f433cc69...)]
                                    [Learnt encTicketPart_key keytype 20 (id=4.1) (f433cc69...)]
                                    [Severity level: Chat]
                                    [Group: Security]
                            keytype: 20
                            keyvalue: f433cc6976ad1d35092e1ee6bdd9af997d585ed51d0aba5593469077ab99a91b
                        crealm: MINDFRUIT.KRB
                        cname
                            name-type: kRB5-NT-PRINCIPAL (1)
                            cname-string: 1 item
                                CNameString: michaelg
                        transited
                            tr-type: 1
                            contents: <MISSING>
                        authtime: Sep 19, 2025 12:33:14.000000000 BST
                        endtime: Sep 20, 2025 12:33:14.000000000 BST
                        renew-till: Sep 19, 2025 12:33:14.000000000 BST
                        authorization-data: 1 item
                            AuthorizationData item
                                ad-type: aD-IF-RELEVANT (1)
                                ad-data […]: 3081a73081a4a00402020080a1819b04819803000000000000000a0000001a0000003800000000000000060000001c0000005800000000000000070000001c000000780000000000000000b97f2f5929dc0110006d00690063006800610065006c0067000000000000001400000071a9
                                    AuthorizationData item
                                        ad-type: aD-WIN2K-PAC (128)
                                        ad-data […]: 03000000000000000a0000001a0000003800000000000000060000001c0000005800000000000000070000001c000000780000000000000000b97f2f5929dc0110006d00690063006800610065006c0067000000000000001400000071a975f5aeb333b1b147ff33ce49a859d23e0e34
                                            Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                [Expert Info (Chat/Security): Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=4)]
                                                    [Used keymap=all_keys num_keys=49 num_tries=4)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                [Expert Info (Chat/Security): Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                    [Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Num Entries: 3
                                            Version: 0
                                            Type: Client Info Type (10)
                                                Size: 26
                                                Offset: 56
                                                PAC_CLIENT_INFO_TYPE: 00b97f2f5929dc0110006d00690063006800610065006c006700
                                                    ClientID: Sep 19, 2025 12:33:14.000000000 BST
                                                    Name Length: 16
                                                    Name: michaelg
                                            Type: Server Checksum (6)
                                                Size: 28
                                                Offset: 88
                                                PAC_SERVER_CHECKSUM: 1400000071a975f5aeb333b1b147ff33ce49a859d23e0e34276420eb
                                                    Type: 20
                                                    Signature: 71a975f5aeb333b1b147ff33ce49a859d23e0e34276420eb
                                            Type: Privsvr Checksum (7)
                                                Size: 28
                                                Offset: 120
                                                PAC_PRIVSVR_CHECKSUM: 14000000fa8aa775f83c08c806a471c66ab9a327d7ea1dabf9a5ff6f
                                                    Type: 20
                                                    Signature: fa8aa775f83c08c806a471c66ab9a327d7ea1dabf9a5ff6f
        enc-part
            etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
            cipher […]: 37683a5a6025463acb3a74fc8904e32d78aa0999d91108181e32f7ad62fe01688c68c4fc83f7b6e41aeb43f0cbc5ced6e09cbc4b2524617e259f9606556aac296f423bdb39012a6ad84826fa1a6a721ff1b3a2abc1d984331ad8a1eedb555561ae733a0312fdf9593453973046e2fca37
                Missing keytype 20 usage 3 (id=missing.1)
                    [Expert Info (Warning/Decryption): Missing keytype 20 usage 3 (id=missing.1)]
                        [Missing keytype 20 usage 3 (id=missing.1)]
                        [Severity level: Warning]
                        [Group: Decryption]
                    [Expert Info (Warning/Decryption): Used keymap=all_keys num_keys=49 num_tries=13)]
                        [Used keymap=all_keys num_keys=49 num_tries=13)]
                        [Severity level: Warning]
                        [Group: Decryption]
    [Response to: 3]
    [Time from request: 0.005412309 seconds]
    Provides learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=0) (f433cc69...)
        [Expert Info (Chat/Security): Provides learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=0) (f433cc69...)]
            [Provides learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=0) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
    Missing keytype 20 usage 3 missing in frame 4 keytype 20 (id=missing.1 same=0) (00000000...)
        [Expert Info (Warning/Decryption): Missing keytype 20 usage 3 missing in frame 4 keytype 20 (id=missing.1 same=0) (00000000...)]
            [Missing keytype 20 usage 3 missing in frame 4 keytype 20 (id=missing.1 same=0) (00000000...)]
            [Severity level: Warning]
            [Group: Decryption]
    Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)
        [Expert Info (Chat/Security): Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Severity level: Chat]
            [Group: Security]
```

TGT-REQ:
```
Frame 5: 1168 bytes on wire (9344 bits), 1168 bytes captured (9344 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 60191, Dst Port: 88
Kerberos
    tgs-req
        pvno: 5
        msg-type: krb-tgs-req (12)
        padata: 2 items
            PA-DATA pA-TGS-REQ
                padata-type: pA-TGS-REQ (1)
                    padata-value […]: 6e8202e1308202dda003020105a10302010ea20703050000000000a38201ee618201ea308201e6a003020105a10f1b0d4d494e4446525549542e4b5242a2223020a003020102a11930171b066b72627467741b0d4d494e4446525549542e4b5242a38201a8308201a4a00302011
                        ap-req
                            pvno: 5
                            msg-type: krb-ap-req (14)
                            Padding: 0
                            ap-options: 00000000
                                0... .... = reserved: False
                                .0.. .... = use-session-key: False
                                ..0. .... = mutual-required: False
                            ticket
                                tkt-vno: 5
                                realm: MINDFRUIT.KRB
                                sname
                                    name-type: kRB5-NT-SRV-INST (2)
                                    sname-string: 2 items
                                        SNameString: krbtgt
                                        SNameString: MINDFRUIT.KRB
                                enc-part
                                    etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                    kvno: 1
                                    cipher […]: e95832a16234355db00c2c9a4ef90ab853b359eaeb68aac2f2d9a7f22d3c82c56fbca07dcc35ad0c07bf9aacf7562cb14665869081ed481fa492f2ad7138d3c030d37850b492f65985e7c47e1f9fe03c6874643d5bcf96ecc3443300747cecfdb8536e7edd695365e08d744deb6237b6d
                                        Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                            [Expert Info (Chat/Security): Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                [Decrypted keytype 20 usage 2 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                [Severity level: Chat]
                                                [Group: Security]
                                            [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=4)]
                                                [Used keymap=all_keys num_keys=49 num_tries=4)]
                                                [Severity level: Chat]
                                                [Group: Security]
                                        encTicketPart
                                            Padding: 0
                                            flags: 40e10000
                                                0... .... = reserved: False
                                                .1.. .... = forwardable: True
                                                ..0. .... = forwarded: False
                                                ...0 .... = proxiable: False
                                                .... 0... = proxy: False
                                                .... .0.. = may-postdate: False
                                                .... ..0. = postdated: False
                                                .... ...0 = invalid: False
                                                1... .... = renewable: True
                                                .1.. .... = initial: True
                                                ..1. .... = pre-authent: True
                                                ...0 .... = hw-authent: False
                                                .... 0... = transited-policy-checked: False
                                                .... .0.. = ok-as-delegate: False
                                                .... ..0. = unused: False
                                                .... ...1 = enc-pa-rep: True
                                                0... .... = anonymous: False
                                            key
                                                Learnt encTicketPart_key keytype 20 (id=5.1) (f433cc69...)
                                                    [Expert Info (Chat/Security): Learnt encTicketPart_key keytype 20 (id=5.1) (f433cc69...)]
                                                        [Learnt encTicketPart_key keytype 20 (id=5.1) (f433cc69...)]
                                                        [Severity level: Chat]
                                                        [Group: Security]
                                                keytype: 20
                                                keyvalue: f433cc6976ad1d35092e1ee6bdd9af997d585ed51d0aba5593469077ab99a91b
                                            crealm: MINDFRUIT.KRB
                                            cname
                                                name-type: kRB5-NT-PRINCIPAL (1)
                                                cname-string: 1 item
                                                    CNameString: michaelg
                                            transited
                                                tr-type: 1
                                                contents: <MISSING>
                                            authtime: Sep 19, 2025 12:33:14.000000000 BST
                                            endtime: Sep 20, 2025 12:33:14.000000000 BST
                                            renew-till: Sep 19, 2025 12:33:14.000000000 BST
                                            authorization-data: 1 item
                                                AuthorizationData item
                                                    ad-type: aD-IF-RELEVANT (1)
                                                    ad-data […]: 3081a73081a4a00402020080a1819b04819803000000000000000a0000001a0000003800000000000000060000001c0000005800000000000000070000001c000000780000000000000000b97f2f5929dc0110006d00690063006800610065006c0067000000000000001400000071a9
                                                        AuthorizationData item
                                                            ad-type: aD-WIN2K-PAC (128)
                                                            ad-data […]: 03000000000000000a0000001a0000003800000000000000060000001c0000005800000000000000070000001c000000780000000000000000b97f2f5929dc0110006d00690063006800610065006c0067000000000000001400000071a975f5aeb333b1b147ff33ce49a859d23e0e34
                                                                Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                                    [Expert Info (Chat/Security): Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                                        [Verified Server checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                                        [Severity level: Chat]
                                                                        [Group: Security]
                                                                    [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=4)]
                                                                        [Used keymap=all_keys num_keys=49 num_tries=4)]
                                                                        [Severity level: Chat]
                                                                        [Group: Security]
                                                                Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                                    [Expert Info (Chat/Security): Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                                        [Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                                        [Severity level: Chat]
                                                                        [Group: Security]
                                                                    [Expert Info (Chat/Security): Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                                        [Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                                        [Severity level: Chat]
                                                                        [Group: Security]
                                                                Num Entries: 3
                                                                Version: 0
                                                                Type: Client Info Type (10)
                                                                    Size: 26
                                                                    Offset: 56
                                                                    PAC_CLIENT_INFO_TYPE: 00b97f2f5929dc0110006d00690063006800610065006c006700
                                                                        ClientID: Sep 19, 2025 12:33:14.000000000 BST
                                                                        Name Length: 16
                                                                        Name: michaelg
                                                                Type: Server Checksum (6)
                                                                    Size: 28
                                                                    Offset: 88
                                                                    PAC_SERVER_CHECKSUM: 1400000071a975f5aeb333b1b147ff33ce49a859d23e0e34276420eb
                                                                        Type: 20
                                                                        Signature: 71a975f5aeb333b1b147ff33ce49a859d23e0e34276420eb
                                                                Type: Privsvr Checksum (7)
                                                                    Size: 28
                                                                    Offset: 120
                                                                    PAC_PRIVSVR_CHECKSUM: 14000000fa8aa775f83c08c806a471c66ab9a327d7ea1dabf9a5ff6f
                                                                        Type: 20
                                                                        Signature: fa8aa775f83c08c806a471c66ab9a327d7ea1dabf9a5ff6f
                            authenticator
                                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                cipher […]: 3646a2195739f63e4e40c34155da9a8da0e44a3702a67ccbb7d8f71f25deb658c31ca01e8caf3524e131829a1740036a2b9e7a4f585e67d4e840bee1bb1f5c282b2338527bfed8546a70fb7de4e20ad23b465896232f8e689d4a04781f9819089e68e01611d497267a649d3751c3de582
                                    Decrypted keytype 20 usage 7 using learnt encTicketPart_key in frame 4 (id=4.1 same=1) (f433cc69...)
                                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 7 using learnt encTicketPart_key in frame 4 (id=4.1 same=1) (f433cc69...)]
                                            [Decrypted keytype 20 usage 7 using learnt encTicketPart_key in frame 4 (id=4.1 same=1) (f433cc69...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=5)]
                                            [Used keymap=all_keys num_keys=49 num_tries=5)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 7 using learnt encTicketPart_key in frame 5 (id=5.1 same=0) (f433cc69...)]
                                            [Decrypted keytype 20 usage 7 using learnt encTicketPart_key in frame 5 (id=5.1 same=0) (f433cc69...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                    authenticator
                                        authenticator-vno: 5
                                        crealm: MINDFRUIT.KRB
                                        cname
                                            name-type: kRB5-NT-PRINCIPAL (1)
                                            cname-string: 1 item
                                                CNameString: michaelg
                                        cksum
                                            cksumtype: cKSUMTYPE-HMAC-SHA384-192-AES256 (20)
                                            checksum: a9a713c5b97ab6661fad6320d213cbc9974faeeeaf9264d3
                                        cusec: 249620
                                        ctime: Sep 19, 2025 12:33:14.000000000 BST
                                        subkey
                                            Learnt authenticator_subkey keytype 20 (id=5.2) (5b29f8aa...)
                                                [Expert Info (Chat/Security): Learnt authenticator_subkey keytype 20 (id=5.2) (5b29f8aa...)]
                                                    [Learnt authenticator_subkey keytype 20 (id=5.2) (5b29f8aa...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            keytype: 20
                                            keyvalue: 5b29f8aacc810ffdf2945d43e36edeffc74eb7e60f3d4c9a3db272dd4a5f6831
            PA-DATA pA-FX-FAST
                padata-type: pA-FX-FAST (136)
                    padata-value […]: a081da3081d7a1233021a003020114a11a0418306295e6ca7895fcaf7c4e73c93c84de1c22c44b0eba7264a281af3081aca003020114a281a40481a1ee44b701933522ccf276ee52d98a2b5e2296248b1821dfa84e8a7d5f40dcad934620505c84f789260c73247010091405c3e
                        armored-data
                            req-checksum
                                cksumtype: cKSUMTYPE-HMAC-SHA384-192-AES256 (20)
                                checksum: 306295e6ca7895fcaf7c4e73c93c84de1c22c44b0eba7264
                            enc-fast-req
                                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                cipher […]: ee44b701933522ccf276ee52d98a2b5e2296248b1821dfa84e8a7d5f40dcad934620505c84f789260c73247010091405c3e8dfc5f86c38645056b605edb6ea01326d16cab8a227c6cbcce303e9ac0cba5350d19311ddd822a270c9f31ae0058dc7b74b50e809808bdcfef76adfd649bb2
                                    Derived KrbFastReq_TGS_armorKey keytype 20 (id=5.3) (01750ba9...)
                                        [Expert Info (Chat/Security): Derived KrbFastReq_TGS_armorKey keytype 20 (id=5.3) (01750ba9...)]
                                            [Derived KrbFastReq_TGS_armorKey keytype 20 (id=5.3) (01750ba9...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                    Decrypted keytype 20 usage 51 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)
                                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 51 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)]
                                            [Decrypted keytype 20 usage 51 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=12)]
                                            [Used keymap=all_keys num_keys=49 num_tries=12)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                    Padding: 0
                                    fast-options: 00000000
                                        0... .... = reserved: False
                                        .0.. .... = hide-client-names: False
                                        ..0. .... = spare_bit2: False
                                        ...0 .... = spare_bit3: False
                                        .... 0... = spare_bit4: False
                                        .... .0.. = spare_bit5: False
                                        .... ..0. = spare_bit6: False
                                        .... ...0 = spare_bit7: False
                                        0... .... = spare_bit8: False
                                        .0.. .... = spare_bit9: False
                                        ..0. .... = spare_bit10: False
                                        ...0 .... = spare_bit11: False
                                        .... 0... = spare_bit12: False
                                        .... .0.. = spare_bit13: False
                                        .... ..0. = spare_bit14: False
                                        .... ...0 = spare_bit15: False
                                        0... .... = kdc-follow-referrals: False
                                    padata: 0 items
                                    req-body
                                        Padding: 0
                                        kdc-options: 40810000
                                            0... .... = reserved: False
                                            .1.. .... = forwardable: True
                                            ..0. .... = forwarded: False
                                            ...0 .... = proxiable: False
                                            .... 0... = proxy: False
                                            .... .0.. = allow-postdate: False
                                            .... ..0. = postdated: False
                                            .... ...0 = unused7: False
                                            1... .... = renewable: True
                                            .0.. .... = unused9: False
                                            ..0. .... = unused10: False
                                            ...0 .... = opt-hardware-auth: False
                                            .... 0... = unused12: False
                                            .... .0.. = unused13: False
                                            .... ..0. = constrained-delegation: False
                                            .... ...1 = canonicalize: True
                                            0... .... = request-anonymous: False
                                            .0.. .... = unused17: False
                                            ..0. .... = unused18: False
                                            ...0 .... = unused19: False
                                            .... 0... = unused20: False
                                            .... .0.. = unused21: False
                                            .... ..0. = unused22: False
                                            .... ...0 = unused23: False
                                            0... .... = unused24: False
                                            .0.. .... = unused25: False
                                            ..0. .... = disable-transited-check: False
                                            ...0 .... = renewable-ok: False
                                            .... 0... = enc-tkt-in-skey: False
                                            .... .0.. = unused29: False
                                            .... ..0. = renew: False
                                            .... ...0 = validate: False
                                        realm: MINDFRUIT.KRB
                                        sname
                                            name-type: kRB5-NT-SRV-HST (3)
                                            sname-string: 2 items
                                                SNameString: HTTP
                                                SNameString: fedora
                                        till: Sep 20, 2025 12:33:14.000000000 BST
                                        nonce: 812528889
                                        etype: 6 items
                                            ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                            ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA256-128 (19)
                                            ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA1-96 (18)
                                            ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA1-96 (17)
                                            ENCTYPE: eTYPE-CAMELLIA256-CTS-CMAC (26)
                                            ENCTYPE: eTYPE-CAMELLIA128-CTS-CMAC (25)
        req-body
            Padding: 0
            kdc-options: 40810000
                0... .... = reserved: False
                .1.. .... = forwardable: True
                ..0. .... = forwarded: False
                ...0 .... = proxiable: False
                .... 0... = proxy: False
                .... .0.. = allow-postdate: False
                .... ..0. = postdated: False
                .... ...0 = unused7: False
                1... .... = renewable: True
                .0.. .... = unused9: False
                ..0. .... = unused10: False
                ...0 .... = opt-hardware-auth: False
                .... 0... = unused12: False
                .... .0.. = unused13: False
                .... ..0. = constrained-delegation: False
                .... ...1 = canonicalize: True
                0... .... = request-anonymous: False
                .0.. .... = unused17: False
                ..0. .... = unused18: False
                ...0 .... = unused19: False
                .... 0... = unused20: False
                .... .0.. = unused21: False
                .... ..0. = unused22: False
                .... ...0 = unused23: False
                0... .... = unused24: False
                .0.. .... = unused25: False
                ..0. .... = disable-transited-check: False
                ...0 .... = renewable-ok: False
                .... 0... = enc-tkt-in-skey: False
                .... .0.. = unused29: False
                .... ..0. = renew: False
                .... ...0 = validate: False
            realm: MINDFRUIT.KRB
            sname
                name-type: kRB5-NT-SRV-HST (3)
                sname-string: 2 items
                    SNameString: HTTP
                    SNameString: fedora
            till: Sep 20, 2025 12:33:14.000000000 BST
            nonce: 812528889
            etype: 6 items
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA256-128 (19)
                ENCTYPE: eTYPE-AES256-CTS-HMAC-SHA1-96 (18)
                ENCTYPE: eTYPE-AES128-CTS-HMAC-SHA1-96 (17)
                ENCTYPE: eTYPE-CAMELLIA256-CTS-CMAC (26)
                ENCTYPE: eTYPE-CAMELLIA128-CTS-CMAC (25)
    [Response in: 6]
    Provides learnt encTicketPart_key in frame 5 keytype 20 (id=5.1 same=0) (f433cc69...)
        [Expert Info (Chat/Security): Provides learnt encTicketPart_key in frame 5 keytype 20 (id=5.1 same=0) (f433cc69...)]
            [Provides learnt encTicketPart_key in frame 5 keytype 20 (id=5.1 same=0) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
    Provides learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)
        [Expert Info (Chat/Security): Provides learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Provides learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
    Provides derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)
        [Expert Info (Chat/Security): Provides derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Provides derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
    Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)
        [Expert Info (Chat/Security): Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Severity level: Chat]
            [Group: Security]
    Used learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)
        [Expert Info (Chat/Security): Used learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [Used learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): Used learnt encTicketPart_key in frame 5 keytype 20 (id=5.1 same=0) (f433cc69...)]
            [Used learnt encTicketPart_key in frame 5 keytype 20 (id=5.1 same=0) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
    Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)
        [Expert Info (Chat/Security): Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
```

TGT-REP
```
Frame 6: 1199 bytes on wire (9592 bits), 1199 bytes captured (9592 bits) on interface lo, id 1
Ethernet II, Src: 00:00:00_00:00:00 (00:00:00:00:00:00), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
Internet Protocol Version 4, Src: 127.0.0.1, Dst: 127.0.0.1
User Datagram Protocol, Src Port: 88, Dst Port: 60191
Kerberos
    tgs-rep
        pvno: 5
        msg-type: krb-tgs-rep (13)
        padata: 1 item
            PA-DATA pA-FX-FAST
                padata-type: pA-FX-FAST (136)
                    padata-value […]: a081e33081e0a081dd3081daa003020114a281d20481cfb46faf963b97dc0917a7d2ad18cce7e0d09b1a98fff74be22f8bf5f6861d6a58ba2b51a73439b0cae2e4af43e0643a3d858bf0e9e5a8369a6a6bf5cf575404dc56827df248ca58bf74b4634e4c7d739738457791efd6d
                        armored-data
                            enc-fast-rep
                                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                                cipher […]: b46faf963b97dc0917a7d2ad18cce7e0d09b1a98fff74be22f8bf5f6861d6a58ba2b51a73439b0cae2e4af43e0643a3d858bf0e9e5a8369a6a6bf5cf575404dc56827df248ca58bf74b4634e4c7d739738457791efd6d1bf62192f53117ada498cb1fe9e7cfde7749b4f4a588406a1e15
                                    Decrypted keytype 20 usage 52 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)
                                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 52 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)]
                                            [Decrypted keytype 20 usage 52 using derived KrbFastReq_TGS_armorKey in frame 5 (id=5.3 same=0) (01750ba9...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=12)]
                                            [Used keymap=all_keys num_keys=49 num_tries=12)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
                                            [Severity level: Chat]
                                            [Group: Security]
                                    padata: 0 items
                                    strengthen-key
                                        Learnt KrbFastResponse_strengthen-key keytype 20 (id=6.1) (8d415f8f...)
                                            [Expert Info (Chat/Security): Learnt KrbFastResponse_strengthen-key keytype 20 (id=6.1) (8d415f8f...)]
                                                [Learnt KrbFastResponse_strengthen-key keytype 20 (id=6.1) (8d415f8f...)]
                                                [Severity level: Chat]
                                                [Group: Security]
                                        keytype: 20
                                        keyvalue: 8d415f8f470cd0a90771bbc1517b758b88389a5224564e7f2a41b98ee966a3b1
                                    finished
                                        timestamp: Sep 19, 2025 12:33:14.000000000 BST
                                        usec: 253394
                                        crealm: MINDFRUIT.KRB
                                        cname
                                            name-type: kRB5-NT-PRINCIPAL (1)
                                            name-string: 1 item
                                                KerberosString: michaelg
                                        ticket-checksum
                                            cksumtype: cKSUMTYPE-HMAC-SHA384-192-AES256 (20)
                                            checksum: 50d4412d25d18f0dc55ea4133ec2c6514684fc3b7c55419c
                                    nonce: 812528889
        crealm: MINDFRUIT.KRB
        cname
            name-type: kRB5-NT-PRINCIPAL (1)
            cname-string: 1 item
                CNameString: michaelg
        ticket
            tkt-vno: 5
            realm: MINDFRUIT.KRB
            sname
                name-type: kRB5-NT-SRV-HST (3)
                sname-string: 2 items
                    SNameString: HTTP
                    SNameString: fedora
            enc-part
                etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
                kvno: 1
                cipher […]: 46a2d172dfaf8bf35e5b0b47fd1113b7ff60243c6e1aa3aa14e2b26d71968625ad241dd1c39a2077cfea0c0652407e202e4cedb127e430e272eb9dd4eda17146b667701e4bc19f6e482afaccaf6ad148a9406b65ce4cf37373a47b67e13f6b199d80c9b1160f0dcb24a01062641e87307
                    Decrypted keytype 20 usage 2 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)
                        [Expert Info (Chat/Security): Decrypted keytype 20 usage 2 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)]
                            [Decrypted keytype 20 usage 2 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)]
                            [Severity level: Chat]
                            [Group: Security]
                        [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=6)]
                            [Used keymap=all_keys num_keys=49 num_tries=6)]
                            [Severity level: Chat]
                            [Group: Security]
                    encTicketPart
                        Padding: 0
                        flags: 40a90000
                            0... .... = reserved: False
                            .1.. .... = forwardable: True
                            ..0. .... = forwarded: False
                            ...0 .... = proxiable: False
                            .... 0... = proxy: False
                            .... .0.. = may-postdate: False
                            .... ..0. = postdated: False
                            .... ...0 = invalid: False
                            1... .... = renewable: True
                            .0.. .... = initial: False
                            ..1. .... = pre-authent: True
                            ...0 .... = hw-authent: False
                            .... 1... = transited-policy-checked: True
                            .... .0.. = ok-as-delegate: False
                            .... ..0. = unused: False
                            .... ...1 = enc-pa-rep: True
                            0... .... = anonymous: False
                        key
                            Learnt encTicketPart_key keytype 20 (id=6.2) (02967044...)
                                [Expert Info (Chat/Security): Learnt encTicketPart_key keytype 20 (id=6.2) (02967044...)]
                                    [Learnt encTicketPart_key keytype 20 (id=6.2) (02967044...)]
                                    [Severity level: Chat]
                                    [Group: Security]
                            keytype: 20
                            keyvalue: 0296704494676b9937795e5ea9a9d9b46fa154f1a482414b0e9d110fe432c41c
                        crealm: MINDFRUIT.KRB
                        cname
                            name-type: kRB5-NT-PRINCIPAL (1)
                            cname-string: 1 item
                                CNameString: michaelg
                        transited
                            tr-type: 1
                            contents: <MISSING>
                        authtime: Sep 19, 2025 12:33:14.000000000 BST
                        endtime: Sep 20, 2025 12:33:14.000000000 BST
                        renew-till: Sep 19, 2025 12:33:14.000000000 BST
                        authorization-data: 1 item
                            AuthorizationData item
                                ad-type: aD-IF-RELEVANT (1)
                                ad-data […]: 3082010830820104a00402020080a181fb0481f805000000000000000a0000001a0000005800000000000000100000001c0000007800000000000000060000001c0000009800000000000000070000001c000000b800000000000000130000001c000000d80000000000000000b97f2f
                                    AuthorizationData item
                                        ad-type: aD-WIN2K-PAC (128)
                                        ad-data […]: 05000000000000000a0000001a0000005800000000000000100000001c0000007800000000000000060000001c0000009800000000000000070000001c000000b800000000000000130000001c000000d80000000000000000b97f2f5929dc0110006d00690063006800610065006c00
                                            Verified Server checksum 20 keytype 20 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)
                                                [Expert Info (Chat/Security): Verified Server checksum 20 keytype 20 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)]
                                                    [Verified Server checksum 20 keytype 20 using keytab principal HTTP/fedora@MINDFRUIT.KRB (id=keytab.1 same=0) (6e9da1ef...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=6)]
                                                    [Used keymap=all_keys num_keys=49 num_tries=6)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                [Expert Info (Chat/Security): Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Verified KDC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                    [Used keymap=longterm_keys num_keys=43 num_tries=2)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Verified Ticket checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                [Expert Info (Chat/Security): Verified Ticket checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Verified Ticket checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=kdc_checksum_key num_keys=1 num_tries=1)]
                                                    [Used keymap=kdc_checksum_key num_keys=1 num_tries=1)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Verified Full PAC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)
                                                [Expert Info (Chat/Security): Verified Full PAC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Verified Full PAC checksum 20 keytype 20 using keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB (id=keytab.30 same=0) (b2446b78...)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                                [Expert Info (Chat/Security): Used keymap=kdc_checksum_key num_keys=1 num_tries=1)]
                                                    [Used keymap=kdc_checksum_key num_keys=1 num_tries=1)]
                                                    [Severity level: Chat]
                                                    [Group: Security]
                                            Num Entries: 5
                                            Version: 0
                                            Type: Client Info Type (10)
                                                Size: 26
                                                Offset: 88
                                                PAC_CLIENT_INFO_TYPE: 00b97f2f5929dc0110006d00690063006800610065006c006700
                                                    ClientID: Sep 19, 2025 12:33:14.000000000 BST
                                                    Name Length: 16
                                                    Name: michaelg
                                            Type: Ticket Checksum (16)
                                                Size: 28
                                                Offset: 120
                                                PAC_TICKET_CHECKSUM: 1400000039976e5f119cb0149ad7b73f5908103028d22191c634742d
                                                    Type: 20
                                                    Signature: 39976e5f119cb0149ad7b73f5908103028d22191c634742d
                                            Type: Server Checksum (6)
                                                Size: 28
                                                Offset: 152
                                                PAC_SERVER_CHECKSUM: 140000008f9112ad20b0dfee8b5dbbc89ce0e8434728a3eb02036959
                                                    Type: 20
                                                    Signature: 8f9112ad20b0dfee8b5dbbc89ce0e8434728a3eb02036959
                                            Type: Privsvr Checksum (7)
                                                Size: 28
                                                Offset: 184
                                                PAC_PRIVSVR_CHECKSUM: 140000007990de2a5b6d7768999f551fe9319a2c2d54c5c4b0682e5d
                                                    Type: 20
                                                    Signature: 7990de2a5b6d7768999f551fe9319a2c2d54c5c4b0682e5d
                                            Type: Full Checksum (19)
                                                Size: 28
                                                Offset: 216
                                                PAC_FULL_CHECKSUM: 140000005468308eeb01e54e63368117bcedfd16e1705227b8cbb842
                                                    Type: 20
                                                    Signature: 5468308eeb01e54e63368117bcedfd16e1705227b8cbb842
        enc-part
            etype: eTYPE-AES256-CTS-HMAC-SHA384-192 (20)
            cipher […]: 5d1c504e72979eae441de3ba450291ed51b205438fd28c1518c403decb192ec1d329271d7a9f1fe97bd03e50aaed29c012ff6eae44ac6f3350db6bfd10aad09a5408f56ca9416c264c1d5cb253572419c9d7f6a1a13ffd0806d9f9080692987009355e2778c6ecebab8073ae909477016
                Derived strengthen-reply-key keytype 20 (id=6.3) (d69223ea...)
                    [Expert Info (Chat/Security): Derived strengthen-reply-key keytype 20 (id=6.3) (d69223ea...)]
                        [Derived strengthen-reply-key keytype 20 (id=6.3) (d69223ea...)]
                        [Severity level: Chat]
                        [Group: Security]
                    [Expert Info (Chat/Security): SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
                        [SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
                        [Severity level: Chat]
                        [Group: Security]
                    [Expert Info (Chat/Security): SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                        [SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                        [Severity level: Chat]
                        [Group: Security]
                Decrypted keytype 20 usage 9 using derived strengthen-reply-key in frame 6 (id=6.3 same=0) (d69223ea...)
                    [Expert Info (Chat/Security): Decrypted keytype 20 usage 9 using derived strengthen-reply-key in frame 6 (id=6.3 same=0) (d69223ea...)]
                        [Decrypted keytype 20 usage 9 using derived strengthen-reply-key in frame 6 (id=6.3 same=0) (d69223ea...)]
                        [Severity level: Chat]
                        [Group: Security]
                    [Expert Info (Chat/Security): Used keymap=all_keys num_keys=49 num_tries=13)]
                        [Used keymap=all_keys num_keys=49 num_tries=13)]
                        [Severity level: Chat]
                        [Group: Security]
                    [Expert Info (Chat/Security): SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
                        [SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
                        [Severity level: Chat]
                        [Group: Security]
                    [Expert Info (Chat/Security): SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                        [SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
                        [Severity level: Chat]
                        [Group: Security]
                encTGSRepPart
                    key
                        Learnt encTGSRepPart_key keytype 20 (id=6.4) (02967044...)
                            [Expert Info (Chat/Security): Learnt encTGSRepPart_key keytype 20 (id=6.4) (02967044...)]
                                [Learnt encTGSRepPart_key keytype 20 (id=6.4) (02967044...)]
                                [Severity level: Chat]
                                [Group: Security]
                        keytype: 20
                        keyvalue: 0296704494676b9937795e5ea9a9d9b46fa154f1a482414b0e9d110fe432c41c
                    last-req: 1 item
                        LastReq item
                            lr-type: lR-NONE (0)
                            lr-value: Jan  1, 1970 01:00:00.000000000 BST
                    nonce: 812528889
                    Padding: 0
                    flags: 40a90000
                        0... .... = reserved: False
                        .1.. .... = forwardable: True
                        ..0. .... = forwarded: False
                        ...0 .... = proxiable: False
                        .... 0... = proxy: False
                        .... .0.. = may-postdate: False
                        .... ..0. = postdated: False
                        .... ...0 = invalid: False
                        1... .... = renewable: True
                        .0.. .... = initial: False
                        ..1. .... = pre-authent: True
                        ...0 .... = hw-authent: False
                        .... 1... = transited-policy-checked: True
                        .... .0.. = ok-as-delegate: False
                        .... ..0. = unused: False
                        .... ...1 = enc-pa-rep: True
                        0... .... = anonymous: False
                    authtime: Sep 19, 2025 12:33:14.000000000 BST
                    endtime: Sep 20, 2025 12:33:14.000000000 BST
                    renew-till: Sep 19, 2025 12:33:14.000000000 BST
                    srealm: MINDFRUIT.KRB
                    sname
                        name-type: kRB5-NT-SRV-HST (3)
                        sname-string: 2 items
                            SNameString: HTTP
                            SNameString: fedora
    [Response to: 5]
    [Time from request: 0.000791655 seconds]
    Provides learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)
        [Expert Info (Chat/Security): Provides learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [Provides learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [Severity level: Chat]
            [Group: Security]
    Provides learnt encTicketPart_key in frame 6 keytype 20 (id=6.2 same=0) (02967044...)
        [Expert Info (Chat/Security): Provides learnt encTicketPart_key in frame 6 keytype 20 (id=6.2 same=0) (02967044...)]
            [Provides learnt encTicketPart_key in frame 6 keytype 20 (id=6.2 same=0) (02967044...)]
            [Severity level: Chat]
            [Group: Security]
    Provides derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)
        [Expert Info (Chat/Security): Provides derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)]
            [Provides derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
    Provides learnt encTGSRepPart_key in frame 6 keytype 20 (id=6.4 same=0) (02967044...)
        [Expert Info (Chat/Security): Provides learnt encTGSRepPart_key in frame 6 keytype 20 (id=6.4 same=0) (02967044...)]
            [Provides learnt encTGSRepPart_key in frame 6 keytype 20 (id=6.4 same=0) (02967044...)]
            [Severity level: Chat]
            [Group: Security]
    Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)
        [Expert Info (Chat/Security): Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Used derived KrbFastReq_TGS_armorKey in frame 5 keytype 20 (id=5.3 same=0) (01750ba9...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [SRC1 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [SRC2 learnt encTicketPart_key in frame 4 keytype 20 (id=4.1 same=1) (f433cc69...)]
            [Severity level: Chat]
            [Group: Security]
    Used keytab principal HTTP/fedora@MINDFRUIT.KRB keytype 20 (id=keytab.1 same=0) (6e9da1ef...)
        [Expert Info (Chat/Security): Used keytab principal HTTP/fedora@MINDFRUIT.KRB keytype 20 (id=keytab.1 same=0) (6e9da1ef...)]
            [Used keytab principal HTTP/fedora@MINDFRUIT.KRB keytype 20 (id=keytab.1 same=0) (6e9da1ef...)]
            [Severity level: Chat]
            [Group: Security]
    Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)
        [Expert Info (Chat/Security): Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Used keytab principal krbtgt/MINDFRUIT.KRB@MINDFRUIT.KRB keytype 20 (id=keytab.30 same=0) (b2446b78...)]
            [Severity level: Chat]
            [Group: Security]
    Used derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)
        [Expert Info (Chat/Security): Used derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)]
            [Used derived strengthen-reply-key in frame 6 keytype 20 (id=6.3 same=0) (d69223ea...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [SRC1 learnt KrbFastResponse_strengthen-key in frame 6 keytype 20 (id=6.1 same=0) (8d415f8f...)]
            [Severity level: Chat]
            [Group: Security]
        [Expert Info (Chat/Security): SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [SRC2 learnt authenticator_subkey in frame 5 keytype 20 (id=5.2 same=0) (5b29f8aa...)]
            [Severity level: Chat]
            [Group: Security]
```

------------------------------------------8<----8<------------------------------------------------
Google Chrome Notes On Websocket 401 Handling
---------------------------------------------

https://docs.google.com/document/d/129rLtf5x3hvhP5rayLiSxnEjOXS8Z7EnLJgBL4CdwjI/edit?tab=t.0

RFC 7235
--------
All HTTP comms are assumed to be stateless. 
Firefox seems to be closing the connection each time we send a 401 response; we see the FIN and RST 
in Wireshark.
https://www.rfc-editor.org/rfc/rfc7235#section-5.1.2
Via https://stackoverflow.com/a/25235099

Reading from /dev/urandom
-------------------------
https://serverfault.com/a/481171
head -c 500 /dev/urandom | tr -dc 'a-zA-Z0-9~!@#$%^&*_-' | fold -w 3

Sibling comment
od -vAn -N4 -tu4 < /dev/urandom
txt:(raze system"od -vAn -N32 -tu8 < /dev/urandom") except " "
